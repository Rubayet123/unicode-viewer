<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>View non-printable unicode characters</title>
<style type="text/css">
body {
	font-family: Helvetica, Arial, sans-serif;
	background-color: #EEEEEE;
}
div.main {
	background-color: white;
	border-radius: 10px;
	border: 2px solid #666666;
	box-shadow: 5px 5px 5px #999999;
	padding: 2.4em 3em;
	margin: 0 auto;
	max-width: 1000px;
}
div.output {
    margin: 3em 0;
    border: 1px solid #666666;
    padding: 0.4em 0.2em;
	font-family: Courier New, Courier, monospaced;
	cursor: default;
}
div.output span.symbol {
	color: white;
	background-color: #999999;
	padding: 0 2px;
	margin: 0 2px;
}
div.output span.hex {
	color: black;
	background-color: #9999FF;
	padding: 0 2px;
	margin: 0 2px;
}

span.S2Tooltip.anchor {
  	white-space: nowrap;
}
span.S2Tooltip.container {
	position: absolute; z-index: 999;
  	left: -99999px; top: -99999px;
}
span.S2Tooltip.anchor:hover {
	background-color: #FF9999;
}
span.S2Tooltip.anchor:hover + span.S2Tooltip.container {
  	left: auto; top: auto;
}
span.S2Tooltip.tiptext {
  	position: absolute;
  	left: -2em; top: 1.5em; 
	padding: 0.5em 0.8em 0.7em 0.8em;
	color: black; background-color: #DDDDFF; border: 1px solid #9999FF;
	font-weight: normal; text-align: left; 
	display: block;
  	text-indent: 0;
}
</style>
</head>
<body>

<div class="main">
	<h1>View non-printable unicode characters</h1>
	<p>Online tool to display non-printable characters that may be hidden in copy&amp;pasted strings.</p>
	
	<div style="margin-top: 3em;">
		Please paste the string here:
	</div>
	<div>
		<textarea id="inputText" rows="8" cols="40" style="width: 100%; box-sizing: border-box;" dir="auto">See what's hidden in your string…or be­hind﻿</textarea>
	</div>
	<div>
		<button type="button" onclick="showCharacters()">Show me the characters</button>
	</div>
	
	<div id="outputDiv"></div>
	<div id="statsDiv" style="margin: -2.5em 0 4em 0;"></div>

    <h2>Helpful Sites for Details on UTF Characters</h2>
    <ul>
        <li><a href="https://www.branah.com/unicode-converter" target="_blank">Branah.com Unicode Converter</a></li>
        <li><a href="http://www.fileformat.info/info/unicode/char/search.htm" target="_blank">FileFormat.Info</a></li>
        <li><a href="http://utf8-chartable.de/unicode-utf8-table.pl" target="_blank">utf8-chartable.de</a></li>
    </ul>
    
    <h2>Privacy Note</h2>
    <p>This web page (tool) does not store any information about you (no cookies, no IP logging) and it does not store any of the
    	text that is written or pasted into the box above.</p>
    <h2>Source Code</h2>
    <p>The source code available on <a href="https://github.com/Rubayet123/unicode-viewer">GitHub</a>.</p>

</div>

<script>
function getCodePoint(char) {
    return char.codePointAt(0);
}

function htmlChar(c) {
    const codePoint = getCodePoint(c);
    let desc, hex, symbol;
    
    if (codePoint < 256) {
        desc = codePoint + '<br>\n0x' + codePoint.toString(16).padStart(2, '0').toUpperCase();
        hex = codePoint.toString(16).padStart(2, '0').toUpperCase();
    } else {
        desc = '&#' + codePoint + ';<br>\n\\u' + codePoint.toString(16).padStart(4, '0').toUpperCase();
        hex = 'U+' + codePoint.toString(16).toUpperCase();
    }
    
    if (c === '\r') {
        symbol = '<span class="symbol S2Tooltip anchor">CR</span>';
    } else if (c === '\n') {
        symbol = '<span class="symbol S2Tooltip anchor">LF</span>';
    } else if (c === '\t') {
        symbol = '<span class="symbol S2Tooltip anchor">⟶</span>&#8203;';
    } else if (c === ' ') {
        symbol = '<span class="white S2Tooltip anchor">·</span>&#8203;';
    } else {
        // Check if character is printable (letters, marks, numbers, punctuation, symbols)
        const isPrintable = /^[\p{L}\p{M}\p{N}\p{P}\p{S}]$/u.test(c);
        if (isPrintable) {
            symbol = '<span class="S2Tooltip anchor">' + c + '</span>';
        } else {
            symbol = '<span class="hex S2Tooltip anchor">' + hex + '</span>';
        }
    }
    
    return symbol + 
        '<span class="S2Tooltip container">' +
        '<span class="S2Tooltip tiptext rounded shadow">' + desc + '</span>' +
        '</span>';
}

function text2html(s) {
    let html = '<div class="output" dir="auto">\n';
    
    const sl = s.length;
    let nlc = 0;
    
    for (let i = 0; i < sl; i++) {
        const c = s[i];
        
        if (c === '\r') {
            if (nlc === 0) {
                nlc = 1;
                html += htmlChar(c);
            } else if (nlc === 1) {
                html += '<br>\n' + htmlChar(c);
                nlc = 1;
            } else if (nlc === 2) {
                html += htmlChar(c) + '<br>\n';
                nlc = 0;
            }
        } else if (c === '\n') {
            const sym = htmlChar(c);
            if (nlc === 0) {
                nlc = 2;
                html += sym;
            } else if (nlc === 2) {
                html += '<br>\n' + htmlChar(c);
                nlc = 2;
            } else if (nlc === 1) {
                html += htmlChar(c) + '<br>\n';
                nlc = 0;
            }
        } else {
            html += htmlChar(c);
        }
    }
    
    return html + '</div>\n';
}

function showCharacters() {
    const text = document.getElementById('inputText').value;
    const outputDiv = document.getElementById('outputDiv');
    const statsDiv = document.getElementById('statsDiv');
    
    outputDiv.innerHTML = text2html(text);
    
    const charCount = text.length;
    const byteCount = new Blob([text]).size;
    statsDiv.textContent = charCount + ' characters, ' + byteCount + ' bytes';
}

// Show default text on load
window.onload = function() {
    showCharacters();
};
</script>

</body>
</html>
